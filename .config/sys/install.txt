Download and write alpine linux extended to an external disk.

On Dell, use F12 to enter BIOS setup, then use Maintenance>Data Wipe
to wipe data.

Boot from Alpine.

Login as root.  There is no password.

Set up networking:

 # -r is needed for starting the network after configuration
 setup-interfaces -r

Set up time:

  setup-ntp busybox

Write date & time to hardware clock:

  hwclock -w

Set up repos:

 setup-apkrepos -c
  # show mirror list, then select geographically nearest mirror
  # -c argument enables community repo

Set up doas and normal user:

  apk add doas
  echo permit :wheel >> /etc/doas.d/permit-wheel.conf
  adduser yc
  # change group
  adduser yc wheel

Install git:

  apk add git

Install encrypted system:

 setup-disk -v -e -m sys -s 0 /dev/sda
 # -v for verbose
 # -e for encrypted
 # -m for system disk
 # -s 0 for no swap (use swap file instead)

Power off, then reboot.

Log in as yc, there is currently no home dir.

Add user home:

  doas -s
  git clone https://github.com/tie-ling/alpine-dots /home/yc
  chown -R yc:yc /home/yc

Install packages:

  apk add $(while read i; do printf "$i "; done < /home/yc/.config/sys/world)


Enable services:

  . /home/yc/.config/sys/rc-update_add.txt

Reboot.

Run emacs once, this will download and build all the packages emacs
needs.  Need a working connection to raw.github:

    e

Visit this very file and copy the following commands:

Download umatrix for firefox:

    wget -O /home/yc/.mozilla/firefox/umatrix-1.4.4.xpi \
    https://addons.mozilla.org/firefox/downloads/file/3812704/umatrix-1.4.4.xpi


Download gpg tar:

    wget https://raw.githubusercontent.com/tie-ling/gpg/main/gpg-2024-02-07.tar.xz

Extract gpg tar, then move to $HOME/.gnupg:

    cd $HOME
    rm -rf $HOME/.gnupg
    # /old/home/yc/gpg
    # ^   ^    ^
    # strip 3 leading components
    tar -C $HOME --strip-components 3 -axf gpg-2024-02-07.tar.xz
    mv $HOME/gpg $HOME/.gnupg

Now $HOME/.gnupg/gpg-agent.conf is missing,

Use following command to restore it.

    git restore .gnupg/gpg-agent.conf

Connect to gpg agent:

    . .ashrc

Get pass words back and tub repo:

    git clone git@github.com:tie-ling/passwd $HOME/.password-store
    git clone git@github.com:tie-ling/tub

Fix git remote for the config repo:

    git -C $HOME remote rm origin
    git -C $HOME remote add origin git@github.com:tie-ling/alpine-dots
    git -C $HOME push -u origin main

Init email:

    mkdir -p $HOME/Mail/gmail
    mu init --maildir $HOME/Mail --my-address gyuchen86@gmail.com --my-address yguo@posteo.net
    mu index

Get math textbooks back.
